<svg id="mermaid-svg" width="100%" xmlns="http://www.w3.org/2000/svg" style="max-width: 729.4810180664062px;" viewBox="-8 -50 729.4810180664062 937.4375" role="graphics-document document" aria-roledescription="flowchart-v2" xmlns:xlink="http://www.w3.org/1999/xlink"><style xmlns="http://www.w3.org/1999/xhtml">@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css");</style><style>#mermaid-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg .error-icon{fill:#552222;}#mermaid-svg .error-text{fill:#552222;stroke:#552222;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:#333333;stroke:#333333;}#mermaid-svg .marker.cross{stroke:#333333;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg .cluster-label text{fill:#333;}#mermaid-svg .cluster-label span,#mermaid-svg p{color:#333;}#mermaid-svg .label text,#mermaid-svg span,#mermaid-svg p{fill:#333;color:#333;}#mermaid-svg .node rect,#mermaid-svg .node circle,#mermaid-svg .node ellipse,#mermaid-svg .node polygon,#mermaid-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg .flowchart-label text{text-anchor:middle;}#mermaid-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-svg .node .label{text-align:center;}#mermaid-svg .node.clickable{cursor:pointer;}#mermaid-svg .arrowheadPath{fill:#333333;}#mermaid-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg .cluster text{fill:#333;}#mermaid-svg .cluster span,#mermaid-svg p{color:#333;}#mermaid-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="mermaid-svg_flowchart-pointEnd" class="marker flowchart" viewBox="0 0 10 10" refX="6" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="mermaid-svg_flowchart-pointStart" class="marker flowchart" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="mermaid-svg_flowchart-circleEnd" class="marker flowchart" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="mermaid-svg_flowchart-circleStart" class="marker flowchart" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="mermaid-svg_flowchart-crossEnd" class="marker cross flowchart" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="mermaid-svg_flowchart-crossStart" class="marker cross flowchart" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M329.629,34L329.629,38.167C329.629,42.333,329.629,50.667,329.629,58.117C329.629,65.567,329.629,72.133,329.629,75.417L329.629,78.7" id="L-id0-id1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id0 LE-id1" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M329.629,137L329.629,141.167C329.629,145.333,329.629,153.667,329.695,161.2C329.761,168.734,329.893,175.467,329.959,178.834L330.025,182.201" id="L-id1-id2-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id1 LE-id2" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M291.045,256.026L258.401,268.206C225.757,280.387,160.468,304.748,127.824,325.512C95.18,346.276,95.18,363.443,95.18,379.026C95.18,394.609,95.18,408.609,95.18,425.776C95.18,442.943,95.18,463.276,95.18,483.609C95.18,503.943,95.18,524.276,95.18,547.262C95.18,570.247,95.18,595.885,95.18,623.107C95.18,650.328,95.18,679.133,95.18,699.985C95.18,720.838,95.18,733.738,95.18,740.188L95.18,746.638" id="L-id2-id3-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id2 LE-id3" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M95.18,785.938L95.18,791.688C95.18,797.438,95.18,808.938,135.76,820.712C176.341,832.486,257.502,844.534,298.083,850.559L338.664,856.583" id="L-id3-id9-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id3 LE-id9" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M363.255,261.983L381.228,273.171C399.2,284.359,435.145,306.734,453.117,322.788C471.09,338.843,471.09,348.576,471.09,353.443L471.09,358.309" id="L-id2-id4-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id2 LE-id4" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M471.09,397.609L471.09,401.776C471.09,405.943,471.09,414.276,471.09,421.726C471.09,429.176,471.09,435.743,471.09,439.026L471.09,442.309" id="L-id4-id5-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id4 LE-id5" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M680.426,451.22L684.315,450.618C688.204,450.016,695.981,448.813,700.842,448.211C705.704,447.609,707.648,447.609,709.592,453.609C711.537,459.609,713.481,471.609,713.481,483.609C713.481,495.609,711.537,507.609,709.592,513.609C707.648,519.609,705.704,519.609,701.715,519.143C697.727,518.676,691.695,517.743,688.679,517.276L685.663,516.81" id="L-id5-id5-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id5 LE-id5" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M471.09,519.609L471.09,523.776C471.09,527.943,471.09,536.276,471.156,543.81C471.222,551.343,471.354,558.077,471.42,561.444L471.486,564.81" id="L-id5-id6-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id5 LE-id6" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M444.682,647.029L433.585,657.181C422.488,667.332,400.295,687.635,389.198,702.653C378.102,717.671,378.102,727.404,378.102,732.271L378.102,737.138" id="L-id6-id7-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id6 LE-id7" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M378.102,795.438L378.102,799.604C378.102,803.771,378.102,812.104,378.102,819.554C378.102,827.004,378.102,833.571,378.102,836.854L378.102,840.138" id="L-id7-id9-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id7 LE-id9" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M498.498,647.029L509.428,657.181C520.358,667.332,542.218,687.635,553.148,707.953C564.078,728.271,564.078,748.604,564.078,767.354C564.078,786.104,564.078,803.271,539.643,817.372C515.208,831.474,466.337,842.511,441.902,848.029L417.467,853.547" id="L-id6-id9-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id6 LE-id9" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(95.1796875, 483.609375)"><g class="label" transform="translate(-13.234375, -9.5)"><foreignObject width="26.46875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Нет</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(471.08984375, 329.109375)"><g class="label" transform="translate(-9.6328125, -9.5)"><foreignObject width="19.265625" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Да</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(378.1015625, 707.9375)"><g class="label" transform="translate(-9.6328125, -9.5)"><foreignObject width="19.265625" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Да</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(564.078125, 768.9375)"><g class="label" transform="translate(-13.234375, -9.5)"><foreignObject width="26.46875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Нет</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default default flowchart-label" id="flowchart-id0-0" data-node="true" data-id="id0" transform="translate(329.62890625, 17)"><rect style="" rx="17" ry="17" x="-38.2421875" y="-17" width="76.484375" height="34"/><g class="label" style="" transform="translate(-26.4921875, -9.5)"><rect/><foreignObject width="52.984375" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Начало</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id1-1" data-node="true" data-id="id1" transform="translate(329.62890625, 110.5)"><rect class="basic label-container" style="" rx="0" ry="0" x="-97.921875" y="-26.5" width="195.84375" height="53"/><g class="label" style="" transform="translate(-90.421875, -19)"><rect/><foreignObject width="180.84375" height="38"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Вызов Sheet::SetCell(...)<br />    Парсим формулу.</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id2-2" data-node="true" data-id="id2" transform="translate(329.62890625, 240.8046875)"><polygon points="53.8046875,0 107.609375,-53.8046875 53.8046875,-107.609375 0,-53.8046875" class="label-container" transform="translate(-53.8046875,53.8046875)" style=""/><g class="label" style="" transform="translate(-29.3046875, -9.5)"><rect/><foreignObject width="58.609375" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Удачно?</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id3-3" data-node="true" data-id="id3" transform="translate(95.1796875, 768.9375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-95.1796875" y="-17" width="190.359375" height="34"/><g class="label" style="" transform="translate(-87.6796875, -9.5)"><rect/><foreignObject width="175.359375" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">throw FormulaException</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id4-4" data-node="true" data-id="id4" transform="translate(471.08984375, 380.609375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-128.3046875" y="-17" width="256.609375" height="34"/><g class="label" style="" transform="translate(-120.8046875, -9.5)"><rect/><foreignObject width="241.609375" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Вызов Cell::GetReferencedCells()</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id5-5" data-node="true" data-id="id5" transform="translate(471.08984375, 483.609375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-209.3359375" y="-36" width="418.671875" height="72"/><g class="label" style="" transform="translate(-201.8359375, -28.5)"><rect/><foreignObject width="403.671875" height="57"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Рекурсивно пробегаем по всем зависимостям ячейки,<br />    отмечая во временном контейнере уже пройденные.<br />    Ищем изменяемую изначально ячейку.</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id6-6" data-node="true" data-id="id6" transform="translate(471.08984375, 621.5234375)"><polygon points="51.9140625,0 103.828125,-51.9140625 51.9140625,-103.828125 0,-51.9140625" class="label-container" transform="translate(-51.9140625,51.9140625)" style=""/><g class="label" style="" transform="translate(-27.4140625, -9.5)"><rect/><foreignObject width="54.828125" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Нашли?</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id7-7" data-node="true" data-id="id7" transform="translate(378.1015625, 768.9375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-137.7421875" y="-26.5" width="275.484375" height="53"/><g class="label" style="" transform="translate(-130.2421875, -19)"><rect/><foreignObject width="260.484375" height="38"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Есть циклическая зависимость.<br />    throw CircularDependencyException</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id9-8" data-node="true" data-id="id9" transform="translate(378.1015625, 862.4375)"><rect style="" rx="17" ry="17" x="-34.1953125" y="-17" width="68.390625" height="34"/><g class="label" style="" transform="translate(-22.4453125, -9.5)"><rect/><foreignObject width="44.890625" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Конец</span></div></foreignObject></g></g></g></g></g><text x="356.7405090332031" y="-25" class="flowchartTitleText">Spreadsheet - Поиск циклических завивсимостей</text></svg>