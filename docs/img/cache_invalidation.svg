<svg id="mermaid-svg" width="100%" xmlns="http://www.w3.org/2000/svg" style="max-width: 472.5625px;" viewBox="-8 -50 472.5625 466" role="graphics-document document" aria-roledescription="flowchart-v2" xmlns:xlink="http://www.w3.org/1999/xlink"><style xmlns="http://www.w3.org/1999/xhtml">@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css");</style><style>#mermaid-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg .error-icon{fill:#552222;}#mermaid-svg .error-text{fill:#552222;stroke:#552222;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:#333333;stroke:#333333;}#mermaid-svg .marker.cross{stroke:#333333;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg .cluster-label text{fill:#333;}#mermaid-svg .cluster-label span,#mermaid-svg p{color:#333;}#mermaid-svg .label text,#mermaid-svg span,#mermaid-svg p{fill:#333;color:#333;}#mermaid-svg .node rect,#mermaid-svg .node circle,#mermaid-svg .node ellipse,#mermaid-svg .node polygon,#mermaid-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg .flowchart-label text{text-anchor:middle;}#mermaid-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-svg .node .label{text-align:center;}#mermaid-svg .node.clickable{cursor:pointer;}#mermaid-svg .arrowheadPath{fill:#333333;}#mermaid-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg .cluster text{fill:#333;}#mermaid-svg .cluster span,#mermaid-svg p{color:#333;}#mermaid-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="mermaid-svg_flowchart-pointEnd" class="marker flowchart" viewBox="0 0 10 10" refX="6" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="mermaid-svg_flowchart-pointStart" class="marker flowchart" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="mermaid-svg_flowchart-circleEnd" class="marker flowchart" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="mermaid-svg_flowchart-circleStart" class="marker flowchart" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="mermaid-svg_flowchart-crossEnd" class="marker cross flowchart" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="mermaid-svg_flowchart-crossStart" class="marker cross flowchart" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M186.32,29.683L171.587,34.569C156.854,39.455,127.388,49.228,112.655,57.397C97.922,65.567,97.922,72.133,97.922,75.417L97.922,78.7" id="L-id0-id1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id0 LE-id1" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M262.805,29.683L277.538,34.569C292.271,39.455,321.737,49.228,336.47,57.397C351.203,65.567,351.203,72.133,351.203,75.417L351.203,78.7" id="L-id0-id2-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id0 LE-id2" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M97.922,118L97.922,122.167C97.922,126.333,97.922,134.667,109.647,142.722C121.372,150.777,144.822,158.554,156.548,162.443L168.273,166.332" id="L-id1-id3-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id1 LE-id3" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M351.203,118L351.203,122.167C351.203,126.333,351.203,134.667,339.478,142.722C327.753,150.777,304.303,158.554,292.577,162.443L280.852,166.332" id="L-id2-id3-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id2 LE-id3" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M224.563,202L224.563,206.167C224.563,210.333,224.563,218.667,224.563,226.117C224.563,233.567,224.563,240.133,224.563,243.417L224.563,246.7" id="L-id3-id4-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id3 LE-id4" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M404.07,256.141L407.959,255.451C411.848,254.761,419.626,253.38,424.487,252.69C429.348,252,431.293,252,433.237,258C435.181,264,437.126,276,437.126,288C437.126,300,435.181,312,433.237,318C431.293,324,429.348,324,425.357,323.464C421.365,322.928,415.327,321.857,412.308,321.321L409.289,320.785" id="L-id4-id4-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id4 LE-id4" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/><path d="M224.563,324L224.563,328.167C224.563,332.333,224.563,340.667,224.563,348.117C224.563,355.567,224.563,362.133,224.563,365.417L224.563,368.7" id="L-id4-id5-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-id4 LE-id5" style="fill:none;" marker-end="url(#mermaid-svg_flowchart-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default default flowchart-label" id="flowchart-id0-0" data-node="true" data-id="id0" transform="translate(224.5625, 17)"><rect style="" rx="17" ry="17" x="-38.2421875" y="-17" width="76.484375" height="34"/><g class="label" style="" transform="translate(-26.4921875, -9.5)"><rect/><foreignObject width="52.984375" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Начало</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id1-1" data-node="true" data-id="id1" transform="translate(97.921875, 101)"><rect class="basic label-container" style="" rx="0" ry="0" x="-97.921875" y="-17" width="195.84375" height="34"/><g class="label" style="" transform="translate(-90.421875, -9.5)"><rect/><foreignObject width="180.84375" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Вызов Sheet::SetCell(...)</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id2-2" data-node="true" data-id="id2" transform="translate(351.203125, 101)"><rect class="basic label-container" style="" rx="0" ry="0" x="-105.359375" y="-17" width="210.71875" height="34"/><g class="label" style="" transform="translate(-97.859375, -9.5)"><rect/><foreignObject width="195.71875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Вызов Sheet::ClearCell(...)</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id3-3" data-node="true" data-id="id3" transform="translate(224.5625, 185)"><rect class="basic label-container" style="" rx="0" ry="0" x="-148.7890625" y="-17" width="297.578125" height="34"/><g class="label" style="" transform="translate(-141.2890625, -9.5)"><rect/><foreignObject width="282.578125" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Вызов Cell::InvalidateCacheRecursive()</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id4-4" data-node="true" data-id="id4" transform="translate(224.5625, 288)"><rect class="basic label-container" style="" rx="0" ry="0" x="-179.5078125" y="-36" width="359.015625" height="72"/><g class="label" style="" transform="translate(-172.0078125, -28.5)"><rect/><foreignObject width="344.015625" height="57"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Для всех ячеек в incoming_refs_ вызываем<br />    Cell::InvalidateCacheRecursive()<br />    для всех ячеек у котороых Cell::IsCacheValid()</span></div></foreignObject></g></g><g class="node default default flowchart-label" id="flowchart-id5-5" data-node="true" data-id="id5" transform="translate(224.5625, 391)"><rect style="" rx="17" ry="17" x="-34.1953125" y="-17" width="68.390625" height="34"/><g class="label" style="" transform="translate(-22.4453125, -9.5)"><rect/><foreignObject width="44.890625" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Конец</span></div></foreignObject></g></g></g></g></g><text x="228.28125" y="-25" class="flowchartTitleText">Spreadsheet - инвалидация кэша</text></svg>