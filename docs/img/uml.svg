<svg id="mermaid-svg" width="100%" xmlns="http://www.w3.org/2000/svg" style="max-width: 975.96875px;" viewBox="0 -50 975.96875 1708" role="graphics-document document" aria-roledescription="classDiagram" xmlns:xlink="http://www.w3.org/1999/xlink"><style xmlns="http://www.w3.org/1999/xhtml">@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css");</style><style>#mermaid-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg .error-icon{fill:#552222;}#mermaid-svg .error-text{fill:#552222;stroke:#552222;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:#333333;stroke:#333333;}#mermaid-svg .marker.cross{stroke:#333333;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg g.classGroup text{fill:#9370DB;stroke:none;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:10px;}#mermaid-svg g.classGroup text .title{font-weight:bolder;}#mermaid-svg .nodeLabel,#mermaid-svg .edgeLabel{color:#131300;}#mermaid-svg .edgeLabel .label rect{fill:#ECECFF;}#mermaid-svg .label text{fill:#131300;}#mermaid-svg .edgeLabel .label span{background:#ECECFF;}#mermaid-svg .classTitle{font-weight:bolder;}#mermaid-svg .node rect,#mermaid-svg .node circle,#mermaid-svg .node ellipse,#mermaid-svg .node polygon,#mermaid-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg .divider{stroke:#9370DB;stroke-width:1;}#mermaid-svg g.clickable{cursor:pointer;}#mermaid-svg g.classGroup rect{fill:#ECECFF;stroke:#9370DB;}#mermaid-svg g.classGroup line{stroke:#9370DB;stroke-width:1;}#mermaid-svg .classLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5;}#mermaid-svg .classLabel .label{fill:#9370DB;font-size:10px;}#mermaid-svg .relation{stroke:#333333;stroke-width:1;fill:none;}#mermaid-svg .dashed-line{stroke-dasharray:3;}#mermaid-svg .dotted-line{stroke-dasharray:1 2;}#mermaid-svg #compositionStart,#mermaid-svg .composition{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg #compositionEnd,#mermaid-svg .composition{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg #dependencyStart,#mermaid-svg .dependency{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg #dependencyStart,#mermaid-svg .dependency{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg #extensionStart,#mermaid-svg .extension{fill:transparent!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg #extensionEnd,#mermaid-svg .extension{fill:transparent!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg #aggregationStart,#mermaid-svg .aggregation{fill:transparent!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg #aggregationEnd,#mermaid-svg .aggregation{fill:transparent!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg #lollipopStart,#mermaid-svg .lollipop{fill:#ECECFF!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg #lollipopEnd,#mermaid-svg .lollipop{fill:#ECECFF!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg .edgeTerminals{font-size:11px;line-height:initial;}#mermaid-svg .classTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><defs><marker id="mermaid-svg_classDiagram-aggregationStart" class="marker aggregation classDiagram" refX="18" refY="7" markerWidth="190" markerHeight="240" orient="auto"><path d="M 18,7 L9,13 L1,7 L9,1 Z"/></marker></defs><defs><marker id="mermaid-svg_classDiagram-aggregationEnd" class="marker aggregation classDiagram" refX="1" refY="7" markerWidth="20" markerHeight="28" orient="auto"><path d="M 18,7 L9,13 L1,7 L9,1 Z"/></marker></defs><defs><marker id="mermaid-svg_classDiagram-extensionStart" class="marker extension classDiagram" refX="18" refY="7" markerWidth="190" markerHeight="240" orient="auto"><path d="M 1,7 L18,13 V 1 Z"/></marker></defs><defs><marker id="mermaid-svg_classDiagram-extensionEnd" class="marker extension classDiagram" refX="1" refY="7" markerWidth="20" markerHeight="28" orient="auto"><path d="M 1,1 V 13 L18,7 Z"/></marker></defs><defs><marker id="mermaid-svg_classDiagram-compositionStart" class="marker composition classDiagram" refX="18" refY="7" markerWidth="190" markerHeight="240" orient="auto"><path d="M 18,7 L9,13 L1,7 L9,1 Z"/></marker></defs><defs><marker id="mermaid-svg_classDiagram-compositionEnd" class="marker composition classDiagram" refX="1" refY="7" markerWidth="20" markerHeight="28" orient="auto"><path d="M 18,7 L9,13 L1,7 L9,1 Z"/></marker></defs><defs><marker id="mermaid-svg_classDiagram-dependencyStart" class="marker dependency classDiagram" refX="6" refY="7" markerWidth="190" markerHeight="240" orient="auto"><path d="M 5,7 L9,13 L1,7 L9,1 Z"/></marker></defs><defs><marker id="mermaid-svg_classDiagram-dependencyEnd" class="marker dependency classDiagram" refX="13" refY="7" markerWidth="20" markerHeight="28" orient="auto"><path d="M 18,7 L9,13 L14,7 L9,1 Z"/></marker></defs><defs><marker id="mermaid-svg_classDiagram-lollipopStart" class="marker lollipop classDiagram" refX="13" refY="7" markerWidth="190" markerHeight="240" orient="auto"><circle stroke="black" fill="transparent" cx="7" cy="7" r="6"/></marker></defs><defs><marker id="mermaid-svg_classDiagram-lollipopEnd" class="marker lollipop classDiagram" refX="1" refY="7" markerWidth="190" markerHeight="240" orient="auto"><circle stroke="black" fill="transparent" cx="7" cy="7" r="6"/></marker></defs><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M164.813,433.5L164.813,440.417C164.813,447.333,164.813,461.167,173.228,473.268C181.643,485.37,198.474,495.74,206.889,500.925L215.305,506.11" id="id_CellInterface_Cell_1" class="  edge-pattern-solid relation" style="fill:none" marker-start="url(#mermaid-svg_classDiagram-extensionStart)"/><path d="M669.797,222L669.797,223.167C669.797,224.333,669.797,226.667,669.797,232C669.797,237.333,669.797,245.667,669.797,249.833L669.797,254" id="id_SheetInterface_Sheet_2" class="  edge-pattern-solid relation" style="fill:none" marker-start="url(#mermaid-svg_classDiagram-extensionStart)"/><path d="M622.688,1268L622.688,1269.167C622.688,1270.333,622.688,1272.667,622.688,1278C622.688,1283.333,622.688,1291.667,622.688,1295.833L622.688,1300" id="id_FormulaInterface_Formula_3" class="  edge-pattern-solid relation" style="fill:none" marker-start="url(#mermaid-svg_classDiagram-extensionStart)"/><path d="M622.688,1381L622.688,1385.167C622.688,1389.333,622.688,1397.667,622.688,1403C622.688,1408.333,622.688,1410.667,622.688,1411.833L622.688,1413" id="id_Formula_FormulaAST_4" class="  edge-pattern-solid relation" style="fill:none" marker-end="url(#mermaid-svg_classDiagram-aggregationEnd)"/><path d="M669.797,450L669.797,454.167C669.797,458.333,669.797,466.667,652.699,478.855C635.601,491.043,601.405,507.086,584.308,515.107L567.21,523.129" id="id_Sheet_Cell_5" class="  edge-pattern-solid relation" style="fill:none" marker-end="url(#mermaid-svg_classDiagram-aggregationEnd)"/><path d="M246.223,923.963L240.506,927.302C234.789,930.642,223.356,937.321,217.639,948.66C211.922,960,211.922,976,211.922,984L211.922,992" id="id_Impl_EmptyImpl_6" class="  edge-pattern-solid relation" style="fill:none" marker-start="url(#mermaid-svg_classDiagram-extensionStart)"/><path d="M383.109,937L383.109,938.167C383.109,939.333,383.109,941.667,383.109,948.917C383.109,956.167,383.109,968.333,383.109,974.417L383.109,980.5" id="id_Impl_TextImpl_7" class="  edge-pattern-solid relation" style="fill:none" marker-start="url(#mermaid-svg_classDiagram-extensionStart)"/><path d="M521.064,901.582L538.001,908.652C554.939,915.722,588.813,929.861,605.75,941.097C622.688,952.333,622.688,960.667,622.688,964.833L622.688,969" id="id_Impl_FormulaImpl_8" class="  edge-pattern-solid relation" style="fill:none" marker-start="url(#mermaid-svg_classDiagram-extensionStart)"/><path d="M383.109,719L383.109,723.167C383.109,727.333,383.109,735.667,383.109,741C383.109,746.333,383.109,748.667,383.109,749.833L383.109,751" id="id_Cell_Impl_9" class="  edge-pattern-solid relation" style="fill:none" marker-end="url(#mermaid-svg_classDiagram-compositionEnd)"/><path d="M622.688,1073L622.688,1077.167C622.688,1081.333,622.688,1089.667,622.688,1095C622.688,1100.333,622.688,1102.667,622.688,1103.833L622.688,1105" id="id_FormulaImpl_FormulaInterface_10" class="  edge-pattern-solid relation" style="fill:none" marker-end="url(#mermaid-svg_classDiagram-aggregationEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="classId-CellInterface-0" data-node="true" data-id="CellInterface" transform="translate(164.8125, 352)"><rect style="" class="outer title-state" x="-156.8125" y="-63.5" width="313.625" height="127"/><line class="divider" x1="-156.8125" x2="156.8125" y1="-32.5" y2="-32.5"/><line class="divider" x1="-156.8125" x2="156.8125" y1="-16.5" y2="-16.5"/><g class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel"></span></div></foreignObject><foreignObject class="classTitle" width="96.515625" height="19" transform="translate( -48.2578125, -56)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">CellInterface</span></div></foreignObject><foreignObject width="140.515625" height="19" transform="translate( -149.3125, -9)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+GetValue() : Value</span></div></foreignObject><foreignObject width="179.953125" height="19" transform="translate( -149.3125, 14)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+GetString() : std::string</span></div></foreignObject><foreignObject width="298.625" height="19" transform="translate( -149.3125, 37)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+GetReferencedCells() : vector&lt;Position&gt;</span></div></foreignObject></g></g><g class="node default" id="classId-Cell-1" data-node="true" data-id="Cell" transform="translate(383.109375, 609.5)"><rect style="" class="outer title-state" x="-167.8046875" y="-109.5" width="335.609375" height="219"/><line class="divider" x1="-167.8046875" x2="167.8046875" y1="-78.5" y2="-78.5"/><line class="divider" x1="-167.8046875" x2="167.8046875" y1="29.5" y2="29.5"/><g class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel"></span></div></foreignObject><foreignObject class="classTitle" width="28.421875" height="19" transform="translate( -14.2109375, -102)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Cell</span></div></foreignObject><foreignObject width="109.640625" height="19" transform="translate( -160.3046875, -67)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-sheet_ Sheet&amp;</span></div></foreignObject><foreignObject width="210.5" height="19" transform="translate( -160.3046875, -44)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-impl_ std::unique_ptr&lt;Impl&gt;</span></div></foreignObject><foreignObject width="320.609375" height="19" transform="translate( -160.3046875, -21)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-referenced_cells_ std::unordered_set&lt;Cell&gt;</span></div></foreignObject><foreignObject width="300.96875" height="19" transform="translate( -160.3046875, 2)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-incoming_refs_ std::unordered_set&lt;Cell&gt;</span></div></foreignObject><foreignObject width="162.1875" height="19" transform="translate( -160.3046875, 37)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">+Set(std::string) : void</span></div></foreignObject><foreignObject width="103.203125" height="19" transform="translate( -160.3046875, 60)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">+Clear() : void</span></div></foreignObject><foreignObject width="233.5625" height="19" transform="translate( -160.3046875, 83)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">+InvalidateCachedValue() : void;</span></div></foreignObject></g></g><g class="node default" id="classId-SheetInterface-2" data-node="true" data-id="SheetInterface" transform="translate(669.796875, 106)"><rect style="" class="outer title-state" x="-138.015625" y="-98" width="276.03125" height="196"/><line class="divider" x1="-138.015625" x2="138.015625" y1="-67" y2="-67"/><line class="divider" x1="-138.015625" x2="138.015625" y1="-51" y2="-51"/><g class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel"></span></div></foreignObject><foreignObject class="classTitle" width="110.5" height="19" transform="translate( -55.25, -90.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">SheetInterface</span></div></foreignObject><foreignObject width="261.03125" height="19" transform="translate( -130.515625, -43.5)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+SetCell(Position, std::string) : void</span></div></foreignObject><foreignObject width="248.0625" height="19" transform="translate( -130.515625, -20.5)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+GetCell(Position) : CellInterface*</span></div></foreignObject><foreignObject width="190.296875" height="19" transform="translate( -130.515625, 2.5)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+ClearCell(Position) : void</span></div></foreignObject><foreignObject width="186.140625" height="19" transform="translate( -130.515625, 25.5)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+GetPrintableSize() : Size</span></div></foreignObject><foreignObject width="251.34375" height="19" transform="translate( -130.515625, 48.5)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+PrintValues(std::ostream&amp;) : void</span></div></foreignObject><foreignObject width="236.1875" height="19" transform="translate( -130.515625, 71.5)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+PrintText(std::ostream&amp;) : void</span></div></foreignObject></g></g><g class="node default" id="classId-Sheet-3" data-node="true" data-id="Sheet" transform="translate(669.796875, 352)"><rect style="" class="outer title-state" x="-298.171875" y="-98" width="596.34375" height="196"/><line class="divider" x1="-298.171875" x2="298.171875" y1="-67" y2="-67"/><line class="divider" x1="-298.171875" x2="298.171875" y1="18" y2="18"/><g class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel"></span></div></foreignObject><foreignObject class="classTitle" width="42.40625" height="19" transform="translate( -21.203125, -90.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Sheet</span></div></foreignObject><foreignObject width="453.5" height="19" transform="translate( -290.671875, -55.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-cells_ : std::unordered_map&lt;Postion, std::unique_ptr&lt; Cell &gt;&gt;</span></div></foreignObject><foreignObject width="194.84375" height="19" transform="translate( -290.671875, -32.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-size_ : std::optional&lt;Size&gt;</span></div></foreignObject><foreignObject width="581.34375" height="19" transform="translate( -290.671875, -9.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-dependant_cells_ std::unordered_map&lt;Postion, std::unordered_set&lt; Position &gt;&gt;</span></div></foreignObject><foreignObject width="249.640625" height="19" transform="translate( -290.671875, 25.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">+GetConcreteCell(Position) : Cell*.</span></div></foreignObject><foreignObject width="376.75" height="19" transform="translate( -290.671875, 48.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-MaybeIncreaseSizeToIncludePosition(Position) : void</span></div></foreignObject><foreignObject width="423.109375" height="19" transform="translate( -290.671875, 71.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-PrintCells(ostream&amp;, std::function&lt;const CellInterface&amp;&gt;)</span></div></foreignObject></g></g><g class="node default" id="classId-FormulaInterface-4" data-node="true" data-id="FormulaInterface" transform="translate(622.6875, 1186.5)"><rect style="" class="outer title-state" x="-156.8125" y="-63.5" width="313.625" height="127"/><line class="divider" x1="-156.8125" x2="156.8125" y1="-32.5" y2="-32.5"/><line class="divider" x1="-156.8125" x2="156.8125" y1="6.5" y2="6.5"/><g class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel"></span></div></foreignObject><foreignObject class="classTitle" width="129.015625" height="19" transform="translate( -64.5078125, -56)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">FormulaInterface</span></div></foreignObject><foreignObject width="190.6875" height="19" transform="translate( -149.3125, -21)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+GetExpression std::string</span></div></foreignObject><foreignObject width="298.046875" height="19" transform="translate( -149.3125, 14)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+Evaluate(const SheetInterface&amp;) : Value</span></div></foreignObject><foreignObject width="298.625" height="19" transform="translate( -149.3125, 37)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+GetReferencedCells() : vector&lt;Position&gt;</span></div></foreignObject></g></g><g class="node default" id="classId-Formula-5" data-node="true" data-id="Formula" transform="translate(622.6875, 1340.5)"><rect style="" class="outer title-state" x="-75.390625" y="-40.5" width="150.78125" height="81"/><line class="divider" x1="-75.390625" x2="75.390625" y1="-9.5" y2="-9.5"/><line class="divider" x1="-75.390625" x2="75.390625" y1="29.5" y2="29.5"/><g class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel"></span></div></foreignObject><foreignObject class="classTitle" width="60.921875" height="19" transform="translate( -30.4609375, -33)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Formula</span></div></foreignObject><foreignObject width="135.78125" height="19" transform="translate( -67.890625, 2)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-ast_ : FormulaAST</span></div></foreignObject></g></g><g class="node default" id="classId-FormulaAST-6" data-node="true" data-id="FormulaAST" transform="translate(622.6875, 1540.5)"><rect style="" class="outer title-state" x="-232.0859375" y="-109.5" width="464.171875" height="219"/><line class="divider" x1="-232.0859375" x2="232.0859375" y1="-78.5" y2="-78.5"/><line class="divider" x1="-232.0859375" x2="232.0859375" y1="-16.5" y2="-16.5"/><g class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel"></span></div></foreignObject><foreignObject class="classTitle" width="89.03125" height="19" transform="translate( -44.515625, -102)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">FormulaAST</span></div></foreignObject><foreignObject width="251.671875" height="19" transform="translate( -224.5859375, -67)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-root_expr : std::unique_ptr&lt;Expr&gt;</span></div></foreignObject><foreignObject width="171.796875" height="19" transform="translate( -224.5859375, -44)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-cells_ std::forward_list</span></div></foreignObject><foreignObject width="449.171875" height="19" transform="translate( -224.5859375, -9)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">+Execute(std::function&lt; double(const std::string&amp;) &gt;) : double</span></div></foreignObject><foreignObject width="168.9375" height="19" transform="translate( -224.5859375, 14)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">+Print(ostream&amp;) : void</span></div></foreignObject><foreignObject width="227.28125" height="19" transform="translate( -224.5859375, 37)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">+PrintFormula(ostream&amp;) : void</span></div></foreignObject><foreignObject width="203.140625" height="19" transform="translate( -224.5859375, 60)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">+PrintCells(ostream&amp;) : void</span></div></foreignObject><foreignObject width="297.1875" height="19" transform="translate( -224.5859375, 83)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">+GetReferencedCells() : std::forward_list</span></div></foreignObject></g></g><g class="node default" id="classId-Impl-7" data-node="true" data-id="Impl" transform="translate(383.109375, 844)"><rect style="" class="outer title-state" x="-121.34375" y="-75" width="242.6875" height="150"/><line class="divider" x1="-121.34375" x2="121.34375" y1="-44" y2="-44"/><line class="divider" x1="-121.34375" x2="121.34375" y1="-28" y2="-28"/><g class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel"></span></div></foreignObject><foreignObject class="classTitle" width="32.25" height="19" transform="translate( -16.125, -67.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Impl</span></div></foreignObject><foreignObject width="167.859375" height="19" transform="translate( -113.84375, -20.5)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+GetText() : std::string</span></div></foreignObject><foreignObject width="140.515625" height="19" transform="translate( -113.84375, 2.5)"><div style="font-style: italic; display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel" style="font-style:italic;">+GetValue() : Value</span></div></foreignObject><foreignObject width="227.6875" height="19" transform="translate( -113.84375, 25.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">+InvalidateCachedValue() : void</span></div></foreignObject><foreignObject width="155.5" height="19" transform="translate( -113.84375, 48.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">+IsCacheValid() : bool</span></div></foreignObject></g></g><g class="node default" id="classId-EmptyImpl-8" data-node="true" data-id="EmptyImpl" transform="translate(211.921875, 1021)"><rect style="" class="outer title-state" x="-47.1484375" y="-29" width="94.296875" height="58"/><line class="divider" x1="-47.1484375" x2="47.1484375" y1="2" y2="2"/><line class="divider" x1="-47.1484375" x2="47.1484375" y1="18" y2="18"/><g class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel"></span></div></foreignObject><foreignObject class="classTitle" width="79.296875" height="19" transform="translate( -39.6484375, -21.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">EmptyImpl</span></div></foreignObject></g></g><g class="node default" id="classId-TextImpl-9" data-node="true" data-id="TextImpl" transform="translate(383.109375, 1021)"><rect style="" class="outer title-state" x="-74.0390625" y="-40.5" width="148.078125" height="81"/><line class="divider" x1="-74.0390625" x2="74.0390625" y1="-9.5" y2="-9.5"/><line class="divider" x1="-74.0390625" x2="74.0390625" y1="29.5" y2="29.5"/><g class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel"></span></div></foreignObject><foreignObject class="classTitle" width="64.640625" height="19" transform="translate( -32.3203125, -33)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">TextImpl</span></div></foreignObject><foreignObject width="133.078125" height="19" transform="translate( -66.5390625, 2)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-text_ : std::string</span></div></foreignObject></g></g><g class="node default" id="classId-FormulaImpl-10" data-node="true" data-id="FormulaImpl" transform="translate(622.6875, 1021)"><rect style="" class="outer title-state" x="-115.5390625" y="-52" width="231.078125" height="104"/><line class="divider" x1="-115.5390625" x2="115.5390625" y1="-21" y2="-21"/><line class="divider" x1="-115.5390625" x2="115.5390625" y1="41" y2="41"/><g class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel"></span></div></foreignObject><foreignObject class="classTitle" width="93.171875" height="19" transform="translate( -46.5859375, -44.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">FormulaImpl</span></div></foreignObject><foreignObject width="209.453125" height="19" transform="translate( -108.0390625, -9.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-formula_ : FormulaInterface</span></div></foreignObject><foreignObject width="216.078125" height="19" transform="translate( -108.0390625, 13.5)"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">-value_ : std::optional&lt;Value&gt;</span></div></foreignObject></g></g></g></g></g><text x="487.984375" y="-25" class="classTitleText">Spreadsheet</text></svg>